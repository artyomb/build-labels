```
git diff --name-only $CI_COMMIT_BEFORE_SHA $CI_COMMIT_SHA | tee ../changes.txt && \
./dc-build.rb -c docker-compose.yml -f ../changes.txt > docker-compose.build.yml && \
./dc-build.rb -c docker-compose.demo.yml -f ../changes.txt > docker-compose.demo.build.yml && \
build-labels -n -c docker-compose.build.yml gitlab set_version to_dockerfiles to_compose | tee bake.yml && \
build-labels -n -c docker-compose.demo.build.yml gitlab set_version to_dockerfiles to_compose | tee bake.demo.yml && \
export OTEL_RESOURCE_ATTRIBUTES=service.name=docker-builder,pipeline.id=${CI_PIPELINE_ID},project.name=${CI_PROJECT_NAME} && \
grep \"services: {}\" bake.yml || REGISTRY_HOST=$CI_REGISTRY_HOST docker buildx bake -f bake.yml --push && \
grep \"services: {}\" bake.demo.yml || REGISTRY_HOST=$CI_REGISTRY_HOST docker buildx bake -f bake.yml --push \

```

# build-labels

This gem allows ...  

```
build-labels simple-compose.yml | docker-compose build -f -

$ build-labels
<%= %x{./bin/build-labels -h} %>
```

https://rdoc.info/gems/build-labels
https://rubydoc.info/gems/build-labels
https://gemdocs.org/gems/build-labels

## Installation
To install the gem

    $ gem install build-labels

## Usage
Create the file `simple-compose.yml` which describes the images to build
```yaml
<%= %x{cat ./examples/simple-compose.yml} %>
```
Then run in the current directory

    $ build-labels -c simple-compose.yml gitlab

This will ...

```yaml
<%= %x{./bin/build-labels -e ./examples/.build-info -c ./examples/simple-compose.yml gitlab } %>
```
